<?php require('utils.php');#printVars();$login = $HTTP_GET_VARS['login'];$file = $HTTP_GET_VARS['file'];	function getSentences($login,$file) {	global $SENTENCES_TABLE;	#$query = "SELECT * FROM $SENTENCES_TABLE WHERE file='$file';";	$q = "select file, sentID, count(sentID), sentence from $SENTENCES_TABLE WHERE file = '$file' group by sentID";		$rows = dbSelect($q, 'getSentences');	return $rows;		}function getAnnotations($login,$file) {	global $MAINEVENTS_TABLE;	$query = "SELECT eventID FROM $MAINEVENTS_TABLE WHERE file='$file' and annotator ='$login';";	$rows = dbSelect($query, 'getSentences');	$eids = array();	foreach ($rows as $row) {		$eids[$row[0]] = 1;	}	#print_r($eids);	return $eids;		}?><!doctype html public "-//W3C//DTD HTML 4.0 //EN"> <html><head><title>TempEval Document <?php echo $file ?> (<?php echo $login ?>)</title><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"><link href="tempeval.css" rel="stylesheet" type="text/css"></head><body><h2>TempEval Document <?php echo $file ?></h2><hr><FORM action="submit.php" method="post"><input type="hidden" name="login" value="<?php echo $login; ?>" /><input type="hidden" name="file" value="<?php echo $file; ?>" /><?php	$sentences = getSentences($login,$file);	$eids = getAnnotations($login,$file);	echo "<table cellpadding=3 border=0>\n";	$count = 0;  	foreach ($sentences as $sentence) 	{		$count = $count + 1;		$id = $sentence[1];		$lid = $sentence[2];		$string = $sentence[3];				# normalize event markup in the sentence, necessary		# because EVENT and TARGETEVENT are mixed		$string = str_replace('<TARGETEVENT', '<EVENT', $string);		$string = str_replace('</TARGETEVENT', '</EVENT', $string);		$string = str_replace('<EVENT', '[<EVENT', $string);		$string = str_replace('</EVENT>', '</EVENT>]', $string);		# add-in the radio buttons		$pattern = '/(<EVENT stem="\S+" aspect="\S+" eid="(e\d+))/';		$replacement = "<input type=radio name=$id value=\$2> \$1";		$string = preg_replace($pattern, $replacement, $string);		$numberOfEvents = substr_count($string, '<EVENT ');		# get all events from the sentence		preg_match_all('/eid="(e\d+)"/', $string, $matches);		#echo '<p>'; print_r($matches[1]); echo '<p>';		# see whether one was marked as the main event				$hasMainEvent = 0;		$mainEvent = '';		foreach ($matches[1] as $eid) {			if ($eids[$eid]) {				$hasMainEvent = 1;				$mainEvent = $eid;			}		} 		if ($numberOfEvents == 1) {			$pattern = '/<input type=radio name=(\d+) value=(e\d+)>/';			$replacement = '<input type=radio name=$1 value=$2 checked>';			$string = preg_replace($pattern, $replacement, $string);		} elseif ($hasMainEvent == 1) {			$pattern = "/<input type=radio name=(\d+) value=($mainEvent)>/";			$replacement = '<input type=radio name=$1 value=$2 checked>';			$string = preg_replace($pattern, $replacement, $string);		}		echo "<tr>\n";		echo "  <td valign=top>$id\n";#		echo "  <td valign=top>$mainEvent\n";		echo "  <td valign=top>";		if ($id == 0) {			echo "<TARGETTIMEX3>$string</TARGETTIMEX3>\n";		} else {			echo "$string\n";		}	}	echo "</table>\n";?><p><input type="submit" value="Submit Judgements" /></p></FORM><hr><table><tr><td>  <form action="index.php" method="get">  <input type="hidden" name="login" value="<?php echo $login; ?>" />  <input type="submit" value="Home" />  </form><td>  <form action="articles.php" method="get">  <input type="hidden" name="login" value="<?php echo $login; ?>" />  <input type="submit" value="Document List" />  </form></table></body></html>